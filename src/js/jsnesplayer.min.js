/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/js/jsnesplayer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var canvas_ctx,image,framebuffer_u8,framebuffer_u32,SCREEN_WIDTH=256,SCREEN_HEIGHT=240,FRAMEBUFFER_SIZE=SCREEN_WIDTH*SCREEN_HEIGHT,AUDIO_BUFFERING=512,SAMPLE_COUNT=4096,SAMPLE_MASK=SAMPLE_COUNT-1,audio_samples_L=new Float32Array(SAMPLE_COUNT),audio_samples_R=new Float32Array(SAMPLE_COUNT),audio_write_cursor=0,audio_read_cursor=0,nes=new jsnes.NES({onFrame:function(e){for(var a=0;a<FRAMEBUFFER_SIZE;a++)framebuffer_u32[a]=4278190080|e[a]},onAudioSample:function(e,a){audio_samples_L[audio_write_cursor]=e,audio_samples_R[audio_write_cursor]=a,audio_write_cursor=audio_write_cursor+1&SAMPLE_MASK}});function onAnimationFrame(){window.requestAnimationFrame(onAnimationFrame),image.data.set(framebuffer_u8),canvas_ctx.putImageData(image,0,0),nes&&nes.frame()}function audio_remain(){return audio_write_cursor-audio_read_cursor&SAMPLE_MASK}function audio_callback(e){var a=e.outputBuffer,n=a.length;audio_remain()<AUDIO_BUFFERING&&nes&&nes.frame();for(var o=a.getChannelData(0),r=a.getChannelData(1),t=0;t<n;t++){var s=audio_read_cursor+t&SAMPLE_MASK;o[t]=audio_samples_L[s],r[t]=audio_samples_R[s]}audio_read_cursor=audio_read_cursor+n&SAMPLE_MASK}function keyboard(e,a){switch(a.keyCode){case 38:e(1,jsnes.Controller.BUTTON_UP);break;case 40:e(1,jsnes.Controller.BUTTON_DOWN);break;case 37:e(1,jsnes.Controller.BUTTON_LEFT);break;case 39:e(1,jsnes.Controller.BUTTON_RIGHT);break;case 65:case 81:e(1,jsnes.Controller.BUTTON_A);break;case 83:case 79:e(1,jsnes.Controller.BUTTON_B);break;case 9:e(1,jsnes.Controller.BUTTON_SELECT);break;case 13:e(1,jsnes.Controller.BUTTON_START)}}function nes_init(e){var a=document.getElementById(e);canvas_ctx=a.getContext("2d"),image=canvas_ctx.getImageData(0,0,SCREEN_WIDTH,SCREEN_HEIGHT),canvas_ctx.fillStyle="black",canvas_ctx.fillRect(0,0,SCREEN_WIDTH,SCREEN_HEIGHT);var n=new ArrayBuffer(image.data.length);framebuffer_u8=new Uint8ClampedArray(n),framebuffer_u32=new Uint32Array(n),window.audio_ctx=new AudioContext;let o=window.audio_ctx.createScriptProcessor(AUDIO_BUFFERING,0,2);o.onaudioprocess=audio_callback,o.connect(window.audio_ctx.destination),$(document).on("click, keypress",(()=>{window.audio_ctx.resume()}))}function nes_boot(e){nes.loadROM(e),window.requestAnimationFrame(onAnimationFrame)}function nes_load_data(e,a){nes_init(e),nes_boot(a)}function nes_load_url(e,a){nes_init(e);var n=new XMLHttpRequest;n.open("GET",a),n.overrideMimeType("text/plain; charset=x-user-defined"),n.onerror=()=>console.log(`Error loading ${a}: ${n.statusText}`),n.onload=function(){200===this.status?nes_boot(this.responseText):0===this.status||n.onerror()},n.send()}document.addEventListener("keydown",(e=>{keyboard(nes.buttonDown,e)})),document.addEventListener("keyup",(e=>{keyboard(nes.buttonUp,e)}));
//# sourceMappingURL=/sm/bb06c02d46e3e429744023fe41c7a020de1f7b56feeadea7dd8c9c63e1c26ee3.map